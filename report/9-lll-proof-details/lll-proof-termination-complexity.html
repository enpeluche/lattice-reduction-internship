<!DOCTYPE html>

<html lang="fr">

<head>
    <!-- metadata -->

    <meta charset="UTF-8">
    <meta name="robots" content="index, follow">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Terminaison et complexité</title>

    <meta name="description"
        content="Preuve de la terminaison et de la complexité de l'algorithme LLL. Démonstration de la borne polynomiale $\mathcal{O}(n^4 \log A)$ basée sur la décroissance de l'invariant $D = \prod d_k$. Analyse de la borne sur la taille des nombres manipulés ($\mathcal{O}(n \log A)$).">

    <meta name="keywords"
        content="terminaison LLL, complexité LLL, borne polynomiale, invariant D, nombre d'échanges, Gram-Schmidt, taille des entiers, borne algorithmique, $\mathcal{O}(n^4 \log A)$">

    <meta name="author" content="Lucas Petit">

    <link rel="icon" href="/assets/img/logo/logo.ico" type="image/x-icon">

    <!-- for rendering latex -->

    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">

    <!-- JS -->
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>

    <!-- ALL STYLESHEET -->

    <link rel="stylesheet" href="../../src/main.css">
</head>

<body>
    <header id="main-header-hihi">
        <nav>
            <ul>
                <li>
                    <a href="../../">
                        <svg style="padding-right: 0.5rem" class="flip-horizontal icon backwardArrow"
                            viewBox="0 0 24 24">
                            <path d="m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"></path>
                        </svg>
                        Réduction de réseaux
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <main>
        <div id="toc-wrapper"></div>

        <div id="article">
            <h3>Terminaison et complexité</h3>

            <div class="paragraph">
                On pose \( \displaystyle A = \max_{1 \leq i \leq n} \| g_i \| \).
            </div>

            <div class="theorem">
                <span class="title">Terminaison et complexité</span>
                <p>
                    L'algorithme LLL termine et utilise \( \mathcal{O}(n^4 \log A) \) opérations arithmétiques sur des
                    entiers.
                <p>
            </div>

            <div class="paragraph">
                La difficulté est de montrer que la boucle Tant que ne va pas s'exécuter indéfiniment.
            </div>

            <div class="lemma">
                <ol>
                    <li>
                        Orthogonalisation de Gram-Schmidt nécessite \( \mathcal{O}(n^3) \) opérations dans \( \Z \).
                    </li>
                    <li>
                        Proprification de \( g_i \) nécessite \( \mathcal{O}(n^2) \) opérations dans \( \Z \).
                    </li>
                    <li>
                        Réduction de \( g_{i-1}, g_{i} \) nécessite \( \mathcal{O}(n) \) opérations dans \( \Z \)
                    </li>
                </ol>
            </div>

            <div class="proof">
                <ol>
                    <li>
                        Il faut utiliser le théorème GSO
                    </li>
                    <li>
                        Une exécution de Proprification partielle de \( g_i \) revient à faire les multiplications
                        \( H=EG \) et \( N=EM \) se font en \( \mathcal{O}(n) \) étapes, ainsi une exécution de
                        Proprification de \( g_i \) nécessite \( \mathcal{O}(n^2) \) opérations dans \( \Z \).
                    </li>
                    <li>
                        Si un échange a lieu à Réduction de $g_{i-1}, g_{i}$, alors seuls \( g^*_{i-1} \), \( g^*_i \),
                        ainsi que les lignes et colonnes \( i-1 \) et \( i \) de la matrice de transition \( M \) sont
                        modifiés,
                        et ces éléments peuvent être mis à jour en \( \mathcal{O}(n) \) opérations.
                    </li>
                </ol>
            </div>

            <div class="paragraph">
                Il reste à borner le nombre d'itérations de la boucle Tant que à l'étape LLL.
            </div>

            <div class="paragraph">
                Pour tout \( 1 \leq k \leq n \), on pose
                \[
                g_k =
                \begin{pmatrix}
                g_1 \\
                \vdots \\
                g_k
                \end{pmatrix}
                \in \Z^{k \times n}
                , \quad d_0=1, \quad d_k = \det(g_k \cdot g_k^T) \in \Z.
                \]
            </div>

            <div class="lemma">
                Pour tout \( 1 \leq k \leq n \), on a :
                \[
                d_k = \prod_{1 \leq l \leq k} \| g_l^* \|^2 > 0.
                \]
            </div>

            <div class="proof">
                <div class="paragraph">
                    <span class="nowrap">
                        Soit \( 1 \leq k \leq n \), on définit \( g_k = U_k g_k^* \) la décomposition de Gram-Schmidt
                        de la famille \( (g_i) _{1 \leq i \leq k} \).
                    </span>
                </div>
                <div class="paragraph">
                    Alors
                    \[
                    d_k = \det(g_k g_k^t)=\det(U_k g_k^* (g_k^*)^t U_k^t) = \det(g_k^* (g_k^*)^t) = \prod_{1 \leq l \leq
                    k} \| g_l^* \|^2 > 0
                    \]
                </div>
            </div>

            <div class="lemma">
                <ol>
                    <li>
                        Proprification de \( g_i \) ne change pas \( d_k \) pour tout \( 1 \leq k \leq n \).
                    </li>
                    <li>
                        Si \( g_{i-1} \) et \( g_i \) sont échangés à l’étape Réduction de \( g_{i-1}, g_{i} \),
                        et si \( d_k^* \) désigne la nouvelle valeur de \( d_k \), alors :
                        \[
                        d_k^* = d_k \quad \text{pour tout } k \neq i - 1, \quad \text{et} \quad d_{i-1}^* \leq
                        \frac{3}{4} d_{i-1}.
                        \]
                    </li>
                </ol>
            </div>

            <div class="proof">
                <div class="paragraph">
                    <ol>
                        <li>
                            D'après le lemme 2.2 Proprification de \( g_i \) ne modifie pas \( g_k^* \) et donc ne
                            modifie pas \( d_k \).
                        </li>
                        <li>
                            Pour \( k \neq i-1\), une exécution de Réduction de \( g_{i-1}, g_{i} \) multiplie \( g_k \)
                            par une matrice de permutation,
                            donc \( d_k^* = d_k \)

                            De plus, on a
                            \[
                            d_{i-1} = \prod_{1 \leq l \leq i-1} \| g_l^* \|^2 = \frac{3}{4} \prod_{1 \leq l \leq i-1} \|
                            h_l^* \|^2 = \frac{3}{4} d_{i-1}^*
                            \]
                        </li>
                    </ol>
                </div>
            </div>

            <div class="paragraph">
                On pose
                \[
                D = \prod_{1 \leq k < n} d_k, \quad \displaystyle A=\max_{1 \leq i \leq n} \| f_i \| \] On désigne \(
                    D_0 \) désigne la valeur de \( D \) au début de l'algorithme, on a \( 1 \leq D \in \Z \) et \[
                    \begin{aligned} D_0 &=\|g^*_1\|^{2(n-1)} \|g^*_2\|^{2(n-2)} \cdots \|g^*_{n-1}\|^2 \\ &\leq
                    \|g_1\|^{2(n-1)} \|g_2\|^{2(n-2)} \cdots \|g_{n-1}\|^2\\ &\leq A^{n(n-1)} \end{aligned} \] Puisque
                    \( f^*_i \) est une projection de \( f_i \) pour tout \( i \). </div>

                    <div class="lemma">
                        <ol>
                            <li>
                                Proprification de \( g_i \) ne modifie pas \( D \).
                            </li>
                            <li>
                                \( D \) diminue d’au moins un facteur \( 3/4 \) si un échange a
                                lieu dans Réduction de \( g_{i-1}, g_{i} \)
                            </li>
                        </ol>
                    </div>

                    <div class="proof">
                        <div class="paragraph">
                            <ol>
                                <li>
                                    D'après le lemme 2.7 Proprification de \( g_i \) ne modifie pas \( d_k \) et donc ne
                                    modifie pas \( D \).
                                </li>
                                <li>
                                    Si \( g_{i-1} \) et \( g_i \) sont échangés lors de l'exécution de Réduction de \(
                                    g_{i-1}, g_{i} \),
                                    en notant \( D^* \) la nouvelle valeur de \( D \), alors d'après le lemme 2.7

                                    \[
                                    d_k^* = d_k, \quad d_{i-1}^* \leq \frac{3}{4} d_{i-1} \text{ donc } D^* \leq
                                    \frac{3}{4} D.
                                    \]
                                </li>
                            </ol>
                        </div>
                    </div>


                    <div class="paragraph">
                        À tout moment de l’algorithme, soit \( e \in \N \) le nombre d’échanges effectués jusqu’à
                        présent,
                        et \( e^* \) le nombre de fois où la branche alternative (le else) dans Réduction de \( g_{i-1},
                        g_{i} \) a été prise.
                    </div>

                    <div class="lemma">
                        On a
                        \[
                        e \leq \log_{4/3} D_0 \in \mathcal{O}(n^2 \log A)
                        \]
                    </div>

                    <div class="proof">
                        Soit \( D_e \) la valeur de \( D \) après \( e \) échanges.

                        On doit avoir
                        \[
                        1 \;\le\; D_e \; \le\;\left(\frac34\right)^{e} D_0 \le\; \left(\frac34\right)^{e}A^{\,n(n-1)}.
                        \]

                        En appliquant \( log_{3/4} \), aux extrémités de l'inégalité.

                        \[
                        0=\log_{3/4}(1) \;\ge\; e + \log_{3/4}(A^{\,n(n-1)})=e + n(n-1)\frac{\log A}{\log(3/4)}.
                        \]

                        On en déduit que \( e \; \leq n(n-1)\frac{\log A}{-\log(3/4)}\) et donc \( e \in \OO(n^2 \log
                        A)\)
                    </div>

                    <div class="proof">
                        <span class="title">Preuve de la terminaison et la complexité</span>

                        <div class="paragraph">
                            Comme \( i \) est décrémenté de \( 1 \) lors d’un échange et incrémenté de \( 1 \) sinon
                            l'entier \( i + e - e^* \) est constant tout au long de LLL.
                        </div>

                        <div class="paragraph">
                            Initialement \( i + e - e^* = 2 \) et à la fin de LLL on a \( n + 1 + e - e^* = 2 \).
                            On en déduit donc que \( e + e^* = 2e + n - 1 \in \OO(n^2 \log A) \).
                            et donc d'après le lemme 2.5 le coût total de \hyperref[step:LLL]{\emph{LLL}} est \( \OO(n^2
                            \times n^2 \log A) \) opérations dans \( \Z \). Ce qui acheve la preuve.
                        </div>
                    </div>

                    <div class="theorem">
                        <p>
                            L'algorithme LLL opère sur des entiers dont la longueur est \( \mathcal{O}(n \log A) \).
                        </p>
                    </div>

                    <div class="paragraph">
                        Il reste à montrer la dernière partie du théorème.
                    </div>

                    <div class="lemma">
                        Soit \( g_1, \dots, g_n \in \Z^n \),
                        et soit \( G^* \) et \( M \) respectivement la base de Gram-Schmidt et la matrice des
                        coefficients associés.
                        Pour tout \( 1 \leq l < k \leq n \), on a : <ol>
                            <li>
                                \( d_{k-1} g_k^* \in \Z^n \)
                            </li>
                            <li>
                                \( d_l \mu_{k,l} \in \Z \)
                            </li>
                            <li>
                                \( |\mu_{k,l}| \leq \sqrt{d_{l-1}} \| g_k \| \)
                            </li>
                            </ol>
                    </div>


                    <div class="proof">
                        <ol>
                            <li>
                                On écrit
                                \[
                                g_k^* = g_k - \sum_{1 \leq l < k}\lambda_{k,l} g_l, \quad \lambda \in \R. \] Soit \( j <
                                    k\). On a \[ 0=\ps{g_k^*}{g_j}=\ps{ g_k - \sum_{1 \leq l < k} \lambda_{k,l}
                                    g_l}{g_j}. \] Ce qui implique \[ \ps{g_k}{g_j}=\sum_{1 \leq l < k} \lambda_{k,l}
                                    \ps{g_l}{g_j} \] On a donc \[ \begin{pmatrix} \ps{g_1}{g_1} & \cdots &
                                    \ps{g_{k-1}}{g_1} \\ \vdots & & \vdots \\ \ps{g_{1}}{g_{k-1}} & \cdots &
                                    \ps{g_{k-1}}{g_{k-1}} \end{pmatrix} \begin{pmatrix} \lambda_{k,1} \\ \vdots \\
                                    \lambda_{k,k-1} \end{pmatrix}=\begin{pmatrix} \ps{g_{k}}{g_{1}} \\ \vdots \\
                                    \ps{g_{k}}{g_{k-1}} \end{pmatrix} \] D'après la règle de Cramer (à citer) on a \[
                                    d_{k-1} \lambda_{k,1}=\frac{ \begin{vmatrix} \ps{g_1}{g_1} & \cdots &
                                    \ps{g_{k-1}}{g_1} \\ \vdots & & \vdots \\ \ps{g_{1}}{g_{k-1}} & \cdots &
                                    \ps{g_{k-1}}{g_{k-1}} \end{vmatrix} }{ \begin{vmatrix} \ps{g_1}{g_1} & \cdots &
                                    \ps{g_{k-1}}{g_1} \\ \vdots & & \vdots \\ \ps{g_{1}}{g_{k-1}} & \cdots &
                                    \ps{g_{k-1}}{g_{k-1}} \end{vmatrix}} det(g_k g_k^t)=\begin{vmatrix} \ps{g_1}{g_1} &
                                    \cdots & \ps{g_{k-1}}{g_1} \\ \vdots & & \vdots \\ \ps{g_{1}}{g_{k-1}} & \cdots &
                                    \ps{g_{k-1}}{g_{k-1}} \end{vmatrix} \in \Z \] </li>

                            <li>
                                \[
                                d_l \mu_{k,l} = d_l \frac{\ps{g_k}{g_l^*}}{\|g_l^*\|^2} = d_l
                                \frac{\ps{g_k}{g_l^*}}{d_l/d_{l-1}} = d_{l-1} \ps{g_k}{g_l^*}=\ps{g_k}{g_l^* d_{l-1}}
                                \in \Z
                                \]
                            </li>

                            <li>
                                \[
                                | \mu_{k,l} | = \frac{ \ps{g_k}{g_l^*} }{\|g_l^*\|}^2 \leq \frac{\|g_k\|}{\|g_l^*\|}
                                \leq \sqrt{d_{l-1}/d_{l}} \|g_k\|\leq \sqrt{d_{l-1}} \|g_k\|
                                \]
                            </li>
                        </ol>
                    </div>

                    <div class="paragraph">

                        Nous avons supposé que \( \|g_k\| \leq A \) pour tout \( k \).
                        Alors \( A \) est également une borne supérieure pour la base orthogonale de Gram-Schmidt
                        initiale :
                        \( \|g_k^*\| \leq A \) pour tout \( k \). <br>


                        On a d'après les lemmes \( \max \left\{ \|g_k^*\| : 1 \leq k \leq n \right\} \) ne croît jamais
                        au cours de l'algorithme.
                        Ainsi, à tout instant et pour tout \( k \), on a :
                        \[
                        \|g_k^*\| \leq A \quad \text{et} \quad d_k = \prod_{1 \leq l \leq k} \|g_l^*\|^2 \leq A^{2k}.
                        \]

                    </div>

                    <div class="lemma">
                        Soit \( 1 \leq k \leq n \).

                        <ol>
                            <li>
                                À tout moment de l’algorithme, sauf éventuellement à l'étape Proprification de \( g_i \)
                                lorsque \( k = i \),
                                on a :
                                \[
                                \|g_k\| \leq \sqrt{n} A.
                                \]
                            </li>
                            <li>
                                À chaque exécution de l’étape Proprification partielle de \( g_i \), on a :
                                \[
                                \|g_i\| \leq n(2A)^n.
                                \]
                            </li>
                        </ol>
                    </div>

                    <div class="proof">
                        <div class="paragraph">
                            <ol>
                                <li>
                                    <div class="paragraph">
                                        Initialement \( \|g_k\| \leq A \) pour tout \( k \).
                                        L'étape Réduction de \( g_{i-1}, g_{i} \) ne modifie pas \( \|g_k\| \), il
                                        suffit donc d'examiner
                                        l'étape Proprification de \( g_i \). On a que \( g_k \), pour \( k \neq i \),
                                        n'est pas affecté
                                        par l'étape Proprification partielle de \( g_i \).
                                    </div>



                                    Soit \( m_i = \max \{ |\mu_{i,l}| : 1 \leq l \leq i \} \). À partir de

                                    \[
                                    g_i = \sum_{1 \leq l \leq i} \mu_{i,l} g^*_l
                                    \]

                                    et de l'orthogonalité des vecteurs \( g^*_l \), on obtient :

                                    \[
                                    \|g_i\|^2 = \sum_{1 \leq l \leq i} \mu_{i,l}^2 \|g^*_l\|^2 \leq n m_i^2 A^2,
                                    \quad \text{donc} \quad
                                    \|g_i\| \leq \sqrt{n}\, m_i A. \tag{4}
                                    \]

                                    À la fin de Proprification de \( g_i \), on a \( m_i = 1 \) par le lemme 2.1.
                                </li>

                                <li>
                                    Le lemme 2.10 et le point 1 impliquent qu'au début de Proprification de \( g_i \),
                                    on a

                                    \[
                                    \begin{aligned}
                                    m_i &\leq \max \left\{ d_l^{1/2} : 1 \leq l \leq i \right\} \cdot \|g_i\| \\
                                    &\leq A^{n-2} \cdot n^{1/2} A \\
                                    &= n^{1/2} A^{n-1}.
                                    \end{aligned}
                                    \]

                                    Considérons maintenant le remplacement effectué à l'étape Proprification partielle
                                    de \( g_i \).
                                    Comme \( m_i \geq 1 \) et que \( |\mu_{j,l}| \leq \tfrac{1}{2} \) pour \( 1 \leq l <
                                        j \), le lemme 2.8 donne : \[ \begin{aligned} |\mu_{i,l} - \lfloor \mu_{i,j}
                                        \rceil \mu_{j,l}| &\leq |\mu_{i,l}| + |\lfloor \mu_{i,j} \rceil| \cdot
                                        |\mu_{j,l}| \\ &\leq m_i + \left(m_i + \tfrac{1}{2} \right) \cdot \tfrac{1}{2}
                                        \\ &=\tfrac{3}{2} m_i + \tfrac{1}{4} \\ &\leq 2m_i \end{aligned} \] pour \( 1
                                        \leq l < j \). Pour \( l=j \), la nouvelle valeur de \( \mu_{i,j} \) est par
                                        construction au plus \( \tfrac{1}{2} \) en valeur absolue, tout comme les
                                        valeurs de \( \mu_{i,l} \) pour \( l> j \), d'après le lemme 2.1.

                                        On en déduit que pour chaque valeur de \( j \), la valeur de \( m_i \) est au
                                        plus doublée.
                                        Ainsi, pendant Proprification de \( g_i \), la valeur de \( m_i \) est
                                        multipliée au plus par un facteur \( 2^{i-1} \leq 2^{n-1} \).

                                        On a donc
                                        \[
                                        m_i \leq n^{1/2}(2A)^{n-1}
                                        \]

                                        Puis
                                        \[
                                        \|g_i\| \leq n^{1/2} m_i A \leq n (2A)^n.
                                        \]
                                </li>
                            </ol>
                        </div>
                    </div>

                    <div class="proof">
                        <span class="title">Preuve du theoreme</span>
                        <ul>
                            <li>
                                Les dénominateurs \( d_l \) des nombres rationnels calculés pendant l’algorithme sont au
                                plus \( A^{2n} \),
                                et leur taille est en \( \mathcal{O}(n \log A) \).
                            </li>
                            <li>
                                Les numérateurs sont majorés en valeur absolue par :
                                <ul>
                                    <li>
                                        \(
                                        \|g_k\|_\infty \leq \|g_k\| \leq n(2A)^n
                                        \)
                                        d'après le lemme 2.11
                                    </li>
                                    <li class="nowrap">
                                        \(
                                        \|d_{k-1} g_k^*\|_\infty \leq \|d_{k-1} g_k^*\| \leq A^{2k - 2} A \leq A^{2n}
                                        \)
                                        d'après le lemme 2.10
                                    </li>
                                    <li class="nowrap">
                                        \(
                                        |d_l \mu_{k,l}| \leq d_l d_{l-1}^{1/2} \|g_l\| \leq A^{2l} A^{l-1} n (2A)^n \leq
                                        n (2A^4)^n \) d'après les lemmes 2.10 et 2.11</li>
                                </ul>
                                <br>
                                et par conséquent, leur taille est aussi en \( \mathcal{O}(n \log A) \).
                            </li>
                        </ul>
                    </div>

            </div>
    </main>

    <footer id="main-footer"></footer>

    <script type="module" src="../../src/main.js"></script>
</body>

</html>